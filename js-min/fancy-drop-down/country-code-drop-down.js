YUI.add("country-code-drop-down",function(a){var b;if(a.one("html").hasClass("modern")){var c,d=1;c=function(b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=[],z=[],A=0,B={};c=b,e=c.all("option"),f=c.get("selectedIndex"),g=a.one("#"+b.getAttribute("mobile-field-id")),i=g.get("parentNode").one(".placeholder"),j="selected-country-code-"+d,m="country-codes-menu-"+d,p=function(){y.push('<div id="'+j+'" class="column selected-country-code">'),y.push('<a href="#'+m+'" role="menuitem" aria-haspopup="true" aria-labelledby="country-name" tabindex="0">'),y.push('<span class="flag-'),y.push(e.item(f).getAttribute("data-country-code")),y.push('"></span>&nbsp;<span class="country-code-arrow-container"><span class="country-code-arrow"></span></span>&nbsp;'),y.push('<span id="country-name" class="clipped">'+e.item(f).get("innerHTML")+"</span>"),y.push(e.item(f).get("value")),y.push("</a>"),y.push("</div>"),y=y.join(""),g.get("parentNode").insertBefore(y,g.get("parentNode").one("label"))},p(),k=a.one("#"+j),r=function(){l=k.get("offsetWidth"),"ltr"===a.one("body").getStyle("direction")?(g.setStyle("paddingLeft",l),i&&i.setStyle("paddingLeft",l)):(g.setStyle("paddingRight",l),i&&i.setStyle("paddingRight",l)),g.setAttribute("placeholder",g.getAttribute("placeholder"))},r(),h=9===a.UA.ie?g.get("offsetWidth")+17+"px":g.get("offsetWidth")+"px",q=function(){z.push('<div class="country-codes-container" id="'+m+'" style="width:'+h+'">'),z.push("<ul>"),e.each(function(a){z.push("<li>"),z.push('<a href="#" role="menuitem" data-code="'+a.get("value")+'">'),z.push('<span class="flag-'),z.push(a.getAttribute("data-country-code")),z.push('"></span>&nbsp;&nbsp;'),z.push(a.get("innerHTML")),z.push("</a>"),z.push("</li>")}),z.push("</ul>"),z.push("</div>"),z=z.join(""),k.append(z),c.hide()},q(),n=a.one("#"+m),x=function(a,b){var c,d=a.one("a").get("innerHTML").replace(/<.*>&nbsp;&nbsp;/g,"");c=d.charCodeAt(0)+"",B[c]?B[c].push(b):(B[c]=[],B[c].push(b))},n.all("li").each(function(a){x(a,A),A+=1}),s=function(b){b.halt(),f=c.get("selectedIndex"),n.setStyle("display","block"),n.all("ul li").item(f).one("a").focus(),g.addClass("highlight-border"),o||(o=a.UA.ie?8===a.UA.ie?parseInt(n.one("ul li a").get("offsetHeight"),0)-.27:parseInt(n.one("ul li a").get("offsetHeight"),0)+.42:parseInt(n.one("ul li a").get("offsetHeight"),0)),n.set("scrollTop",o*f),a.fire("hide-country-codes-container",null,n)},k.on("click",s),k.on("keydown",function(a){(40===a.keyCode||38===a.keyCode)&&(a.halt(),s(a))}),u=function(){n.all("ul li").item(f).one("a").focus(),n.set("scrollTop",o*f)},n.on("keydown",function(a){switch((38===a.keyCode||40===a.keyCode||9===a.keyCode)&&a.halt(),menuSize=n.all("ul li").size(),a.keyCode){case 38:0===f&&(f=menuSize),f-=1,u();break;case 40:f===menuSize-1&&(f=-1),f+=1,u();break;case 9:g.focus(),n.setStyle("display","none");break;case 27:k.one("a").focus(),n.setStyle("display","none")}}),n.on("keydown",function(a){a.keyCode!==v?w=0:(w+=1,w===B[a.keyCode+""].length&&(w=0)),menuSize=n.all("ul li").size(),B[a.keyCode+""]&&(f=B[a.keyCode+""][w],u(),v=a.keyCode)}),n.on("mouseover",function(a){a.halt(),a.target.focus(),f=n.all("li").indexOf(a.target.get("parentNode")),g.addClass("highlight-border")}),t=function(b){b.halt();var d=b.target.getAttribute("data-code"),e=[];e.push('<span class="'),e.push(b.target.one("span").get("className")),e.push('"></span>&nbsp;<span class="country-code-arrow-container"><span class="country-code-arrow"></span></span>&nbsp;'),e.push(d),k.one("a").set("innerHTML",e.join("")),r(),n.setStyle("display","none"),f=n.all("li").indexOf(b.target.get("parentNode")),c.set("selectedIndex",f),a.fire("country-code-change",null,c),g.focus()},n.all("li").on("click",t),n.all("li").on("mousedown",t),n.all("a").on("blur",function(){g.removeClass("highlight-border")}),n.all("a").on("focus",function(a){a.halt(),g.addClass("highlight-border")}),k.one("a").on("focus",function(){g.addClass("highlight-border")}),k.one("a").on("blur",function(){g.removeClass("highlight-border")}),g.on("blur",function(){this.removeClass("highlight-border")}),d++},a.all("[data=country-code-drop-down]").each(function(a){c(a)}),b=a.all(".country-codes-container"),hideCountryCodesContainer=function(a){b.each(function(b){b!==a&&"block"===b.getStyle("display")&&b.setStyle("display","none")})},a.on("click",hideCountryCodesContainer,"body"),a.on("hide-country-codes-container",function(a,b){hideCountryCodesContainer(b)})}});